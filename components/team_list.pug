- var production = (process.env.PENGUIN_ENV === 'production')

unless (fields.teamMembers == null)

  -
    var current = fields.teamMembers.filter( (p) => {
      return (p.enddate == '' || p.enddate == null)
    })
    var past = fields.teamMembers.filter( (p) => {
      return (p.enddate != '' && p.enddate != null)
    })
    var currentSorted = current.sort(
      (a, b) => {
        // a first!
        if ( b.startdate == null || b.startdate == '' ) { return -1 }
        // b first!
        if ( a.startdate == null || a.startdate == '' ) { return 1 }
        // b first! (smaller date)
        if ( a.startdate < b.startdate) { return -1 }
        // a first! (smaller date)
        if ( b.startdate < a.startdate ) { return 1 }
        return 0;
      }
    )
    var pastSorted = past.sort(
      (a, b) => {
        // b first!
        if ( b.enddate == null || b.enddate == '' ) { return 1 }
        // a first!
        if ( a.enddate == null || a.enddate == '' ) { return -1 }
        // a first! (greater date)
        if ( a.enddate > b.enddate) { return -1 }
        // b first! (greater date)
        if ( b.enddate > a.enddate ) { return 1 }
        return 0;
      }
    )

  - var small = (props.type == 'stem' ? true : false )  
  //- each m in sortedTeamMembers
  each m in currentSorted.concat(pastSorted)
    //- id, image, name, content, type
    if ( props.type == m.type )
      
      li(class=small ? 'small' : '').eqHeight
        .team-member
          .wrapper
            .tm-img(style=`background-image: url(${m.image}); background-size: cover;`)
            .tm-info
              .member-title
                strong !{m.name}
                small !{m.startdate}!{(m.enddate != null && m.enddate != '') ? ' â€” ' + m.enddate : ' - current'}
              if ( small && !production )
                br
                a.btn.btn-alt.btn-medium(href=`/${language}/team/${m.id}`) Edit
              unless small
                .member-info
                  p !{m.content}
                  unless (m.url === '' || m.url == null)
                    a.btn.btn-alt.btn-medium(href=m.url) Read more
                  unless production
                    a.btn.btn-alt.btn-medium(href=`/${language}/team/${m.id}`) Edit
                    
          .info-close
            img(src='/static/img/close-icon.svg', width='20px', alt='')
              
    //- TYPE MISSING!
    else if ( ( m.type == null || m.type === '' ) && !production && props.type == 'stem' )
      li(class=small ? 'small' : '' style='background-color: #F9211B; padding: 15px; opacity: 0.5;')
        .team-member
          span.tm-img(style=`background-image: url(${m.image}); background-size: cover;`)
          strong !{m.name} #[br] #[small TYPE MISSING!]
          if ( small && !production )
            a.btn.btn-alt.btn-medium(href=`/${language}/team/${m.id}`) Edit
        unless small
          .member-info
            p !{m.content}
            unless (m.url === '' || m.url == null)
              a.btn.btn-alt.btn-medium(href=m.url) Read more
            unless production
              a.btn.btn-alt.btn-medium(href=`/${language}/team/${m.id}`) Edit
